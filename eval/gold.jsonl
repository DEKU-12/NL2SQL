{"domain":"chinook","question":"top 5 customers by spend","gold_sql":"SELECT c.customer_id, c.first_name, c.last_name, SUM(i.total) AS total_spend FROM customer c JOIN invoice i ON i.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_spend DESC LIMIT 5;"}
{"domain":"chinook","question":"total invoices per country","gold_sql":"SELECT i.billing_country AS country, COUNT(*) AS invoice_count FROM invoice i GROUP BY i.billing_country ORDER BY invoice_count DESC LIMIT 200;"}
{"domain":"chinook","question":"top 5 cities by invoice count","gold_sql":"SELECT i.billing_city AS city, COUNT(*) AS invoice_count FROM invoice i GROUP BY i.billing_city ORDER BY invoice_count DESC LIMIT 5;"}
{"domain":"chinook","question":"average invoice total","gold_sql":"SELECT AVG(i.total) AS avg_invoice_total FROM invoice i LIMIT 200;"}
{"domain":"chinook","question":"total revenue overall","gold_sql":"SELECT SUM(i.total) AS total_revenue FROM invoice i LIMIT 200;"}
{"domain":"chinook","question":"top 10 customers by number of invoices","gold_sql":"SELECT c.customer_id, c.first_name, c.last_name, COUNT(i.invoice_id) AS invoice_count FROM customer c JOIN invoice i ON i.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY invoice_count DESC LIMIT 10;"}
{"domain":"chinook","question":"customers who never made a purchase","gold_sql":"SELECT c.customer_id, c.first_name, c.last_name, c.email FROM customer c LEFT JOIN invoice i ON i.customer_id = c.customer_id WHERE i.invoice_id IS NULL ORDER BY c.customer_id LIMIT 200;"}
{"domain":"chinook","question":"top 10 artists by total track sales","gold_sql":"SELECT ar.artist_id, ar.name AS artist, SUM(il.unit_price * il.quantity) AS total_sales FROM artist ar JOIN album al ON al.artist_id = ar.artist_id JOIN track t ON t.album_id = al.album_id JOIN invoice_line il ON il.track_id = t.track_id GROUP BY ar.artist_id, ar.name ORDER BY total_sales DESC LIMIT 10;"}
{"domain":"chinook","question":"top 5 albums by number of tracks","gold_sql":"SELECT al.album_id, al.title AS album, COUNT(t.track_id) AS num_tracks FROM album al JOIN track t ON t.album_id = al.album_id GROUP BY al.album_id, al.title ORDER BY num_tracks DESC LIMIT 5;"}
{"domain":"chinook","question":"top 5 genres by number of tracks","gold_sql":"SELECT g.genre_id, g.name AS genre, COUNT(t.track_id) AS num_tracks FROM genre g JOIN track t ON t.genre_id = g.genre_id GROUP BY g.genre_id, g.name ORDER BY num_tracks DESC LIMIT 5;"}
{"domain":"chinook","question":"number of distinct customers","gold_sql":"SELECT COUNT(*) AS customer_count FROM customer LIMIT 200;"}
{"domain":"chinook","question":"number of distinct artists","gold_sql":"SELECT COUNT(*) AS artist_count FROM artist LIMIT 200;"}
{"domain":"chinook","question":"tracks per album","gold_sql":"SELECT al.album_id, al.title AS album, COUNT(t.track_id) AS track_count FROM album al JOIN track t ON t.album_id = al.album_id GROUP BY al.album_id, al.title ORDER BY track_count DESC LIMIT 200;"}
{"domain":"chinook","question":"albums per artist","gold_sql":"SELECT ar.artist_id, ar.name AS artist, COUNT(al.album_id) AS album_count FROM artist ar JOIN album al ON al.artist_id = ar.artist_id GROUP BY ar.artist_id, ar.name ORDER BY album_count DESC LIMIT 200;"}
{"domain":"chinook","question":"artists with most albums","gold_sql":"SELECT ar.artist_id, ar.name AS artist, COUNT(al.album_id) AS album_count FROM artist ar JOIN album al ON al.artist_id = ar.artist_id GROUP BY ar.artist_id, ar.name ORDER BY album_count DESC LIMIT 10;"}
{"domain":"chinook","question":"top 5 tracks by unit price","gold_sql":"SELECT t.track_id, t.name AS track, t.unit_price FROM track t ORDER BY t.unit_price DESC, t.track_id ASC LIMIT 5;"}
{"domain":"chinook","question":"longest track overall","gold_sql":"SELECT t.track_id, t.name AS track, t.milliseconds FROM track t ORDER BY t.milliseconds DESC LIMIT 1;"}
{"domain":"chinook","question":"top 10 longest tracks","gold_sql":"SELECT t.track_id, t.name AS track, t.milliseconds FROM track t ORDER BY t.milliseconds DESC LIMIT 10;"}
{"domain":"chinook","question":"playlists with most tracks","gold_sql":"SELECT p.playlist_id, p.name AS playlist, COUNT(pt.track_id) AS track_count FROM playlist p JOIN playlist_track pt ON pt.playlist_id = p.playlist_id GROUP BY p.playlist_id, p.name ORDER BY track_count DESC LIMIT 10;"}
{"domain":"chinook","question":"tracks that appear in the most playlists","gold_sql":"SELECT t.track_id, t.name AS track, COUNT(pt.playlist_id) AS playlist_count FROM track t JOIN playlist_track pt ON pt.track_id = t.track_id GROUP BY t.track_id, t.name ORDER BY playlist_count DESC LIMIT 10;"}

{"domain":"dvdrental","question":"top 5 customers by total payments","gold_sql":"SELECT c.customer_id, c.first_name, c.last_name, SUM(p.amount) AS total_payments FROM customer c JOIN payment p ON p.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_payments DESC LIMIT 5;"}
{"domain":"dvdrental","question":"top 10 customers by total payments","gold_sql":"SELECT c.customer_id, c.first_name, c.last_name, SUM(p.amount) AS total_payments FROM customer c JOIN payment p ON p.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_payments DESC LIMIT 10;"}
{"domain":"dvdrental","question":"most rented film titles","gold_sql":"SELECT f.film_id, f.title, COUNT(*) AS rental_count FROM rental r JOIN inventory i ON i.inventory_id = r.inventory_id JOIN film f ON f.film_id = i.film_id GROUP BY f.film_id, f.title ORDER BY rental_count DESC LIMIT 10;"}
{"domain":"dvdrental","question":"top 5 categories by rentals","gold_sql":"SELECT c.category_id, c.name AS category, COUNT(*) AS rental_count FROM rental r JOIN inventory i ON i.inventory_id = r.inventory_id JOIN film f ON f.film_id = i.film_id JOIN film_category fc ON fc.film_id = f.film_id JOIN category c ON c.category_id = fc.category_id GROUP BY c.category_id, c.name ORDER BY rental_count DESC LIMIT 5;"}
{"domain":"dvdrental","question":"total revenue by month","gold_sql":"SELECT DATE_TRUNC('month', p.payment_date) AS month, SUM(p.amount) AS revenue FROM payment p GROUP BY month ORDER BY month LIMIT 200;"}
{"domain":"dvdrental","question":"total revenue by year","gold_sql":"SELECT DATE_TRUNC('year', p.payment_date) AS year, SUM(p.amount) AS revenue FROM payment p GROUP BY year ORDER BY year LIMIT 200;"}
{"domain":"dvdrental","question":"average rental duration in days","gold_sql":"SELECT AVG(EXTRACT(EPOCH FROM (r.return_date - r.rental_date)) / 86400.0) AS avg_days FROM rental r WHERE r.return_date IS NOT NULL LIMIT 200;"}
{"domain":"dvdrental","question":"films never rented","gold_sql":"SELECT f.film_id, f.title FROM film f LEFT JOIN inventory i ON i.film_id = f.film_id LEFT JOIN rental r ON r.inventory_id = i.inventory_id WHERE r.rental_id IS NULL ORDER BY f.film_id LIMIT 200;"}
{"domain":"dvdrental","question":"customers who rented more than 10 times","gold_sql":"SELECT c.customer_id, c.first_name, c.last_name, COUNT(r.rental_id) AS rentals FROM customer c JOIN rental r ON r.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name HAVING COUNT(r.rental_id) > 10 ORDER BY rentals DESC LIMIT 200;"}
{"domain":"dvdrental","question":"store with highest revenue","gold_sql":"SELECT s.store_id, SUM(p.amount) AS revenue FROM store s JOIN staff st ON st.store_id = s.store_id JOIN payment p ON p.staff_id = st.staff_id GROUP BY s.store_id ORDER BY revenue DESC LIMIT 1;"}
{"domain":"dvdrental","question":"revenue by store","gold_sql":"SELECT s.store_id, SUM(p.amount) AS revenue FROM store s JOIN staff st ON st.store_id = s.store_id JOIN payment p ON p.staff_id = st.staff_id GROUP BY s.store_id ORDER BY revenue DESC LIMIT 200;"}
{"domain":"dvdrental","question":"revenue by staff member","gold_sql":"SELECT st.staff_id, st.first_name, st.last_name, SUM(p.amount) AS revenue FROM staff st JOIN payment p ON p.staff_id = st.staff_id GROUP BY st.staff_id, st.first_name, st.last_name ORDER BY revenue DESC LIMIT 200;"}
{"domain":"dvdrental","question":"top 5 staff by revenue","gold_sql":"SELECT st.staff_id, st.first_name, st.last_name, SUM(p.amount) AS revenue FROM staff st JOIN payment p ON p.staff_id = st.staff_id GROUP BY st.staff_id, st.first_name, st.last_name ORDER BY revenue DESC LIMIT 5;"}
{"domain":"dvdrental","question":"top 10 cities by customers","gold_sql":"SELECT ci.city_id, ci.city, COUNT(c.customer_id) AS customers FROM customer c JOIN address a ON a.address_id = c.address_id JOIN city ci ON ci.city_id = a.city_id GROUP BY ci.city_id, ci.city ORDER BY customers DESC LIMIT 10;"}
{"domain":"dvdrental","question":"top 10 countries by customers","gold_sql":"SELECT co.country_id, co.country, COUNT(c.customer_id) AS customers FROM customer c JOIN address a ON a.address_id = c.address_id JOIN city ci ON ci.city_id = a.city_id JOIN country co ON co.country_id = ci.country_id GROUP BY co.country_id, co.country ORDER BY customers DESC LIMIT 10;"}
{"domain":"dvdrental","question":"actors with most films","gold_sql":"SELECT a.actor_id, a.first_name, a.last_name, COUNT(fa.film_id) AS film_count FROM actor a JOIN film_actor fa ON fa.actor_id = a.actor_id GROUP BY a.actor_id, a.first_name, a.last_name ORDER BY film_count DESC LIMIT 10;"}
{"domain":"dvdrental","question":"films with the highest rental rate","gold_sql":"SELECT f.film_id, f.title, f.rental_rate FROM film f ORDER BY f.rental_rate DESC, f.film_id ASC LIMIT 10;"}
{"domain":"dvdrental","question":"ratings distribution (count of films per rating)","gold_sql":"SELECT f.rating, COUNT(*) AS film_count FROM film f GROUP BY f.rating ORDER BY film_count DESC LIMIT 200;"}
{"domain":"dvdrental","question":"inventory count per film","gold_sql":"SELECT f.film_id, f.title, COUNT(i.inventory_id) AS inventory_count FROM film f JOIN inventory i ON i.film_id = f.film_id GROUP BY f.film_id, f.title ORDER BY inventory_count DESC LIMIT 200;"}
{"domain":"dvdrental","question":"payment revenue by month","gold_sql":"SELECT DATE_TRUNC('month', p.payment_date) AS month, SUM(p.amount) AS revenue FROM payment p GROUP BY month ORDER BY month LIMIT 200;"}

{"domain":"northwind","question":"top 5 customers by total order value","gold_sql":"SELECT c.customer_id, c.company_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_value FROM customers c JOIN orders o ON o.customer_id = c.customer_id JOIN order_details od ON od.order_id = o.order_id GROUP BY c.customer_id, c.company_name ORDER BY total_value DESC LIMIT 5;"}
{"domain":"northwind","question":"top 10 customers by total order value","gold_sql":"SELECT c.customer_id, c.company_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_value FROM customers c JOIN orders o ON o.customer_id = c.customer_id JOIN order_details od ON od.order_id = o.order_id GROUP BY c.customer_id, c.company_name ORDER BY total_value DESC LIMIT 10;"}
{"domain":"northwind","question":"customers with no orders","gold_sql":"SELECT c.customer_id, c.company_name FROM customers c LEFT JOIN orders o ON o.customer_id = c.customer_id WHERE o.order_id IS NULL ORDER BY c.customer_id LIMIT 200;"}
{"domain":"northwind","question":"revenue by country (ship_country)","gold_sql":"SELECT o.ship_country AS country, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY o.ship_country ORDER BY revenue DESC LIMIT 200;"}
{"domain":"northwind","question":"monthly revenue trend (by order_date)","gold_sql":"SELECT DATE_TRUNC('month', o.order_date) AS month, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY month ORDER BY month LIMIT 200;"}
{"domain":"northwind","question":"yearly revenue trend (by order_date)","gold_sql":"SELECT DATE_TRUNC('year', o.order_date) AS year, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY year ORDER BY year LIMIT 200;"}
{"domain":"northwind","question":"top selling products by quantity","gold_sql":"SELECT p.product_id, p.product_name, SUM(od.quantity) AS total_qty FROM products p JOIN order_details od ON od.product_id = p.product_id GROUP BY p.product_id, p.product_name ORDER BY total_qty DESC LIMIT 10;"}
{"domain":"northwind","question":"top selling products by revenue","gold_sql":"SELECT p.product_id, p.product_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue FROM products p JOIN order_details od ON od.product_id = p.product_id GROUP BY p.product_id, p.product_name ORDER BY revenue DESC LIMIT 10;"}
{"domain":"northwind","question":"top categories by sales","gold_sql":"SELECT cat.category_id, cat.category_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS sales FROM categories cat JOIN products p ON p.category_id = cat.category_id JOIN order_details od ON od.product_id = p.product_id GROUP BY cat.category_id, cat.category_name ORDER BY sales DESC LIMIT 10;"}
{"domain":"northwind","question":"top 5 suppliers by sales","gold_sql":"SELECT s.supplier_id, s.company_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS sales FROM suppliers s JOIN products p ON p.supplier_id = s.supplier_id JOIN order_details od ON od.product_id = p.product_id GROUP BY s.supplier_id, s.company_name ORDER BY sales DESC LIMIT 5;"}
{"domain":"northwind","question":"most used shipper","gold_sql":"SELECT sh.shipper_id, sh.company_name, COUNT(o.order_id) AS orders_shipped FROM shippers sh JOIN orders o ON o.ship_via = sh.shipper_id GROUP BY sh.shipper_id, sh.company_name ORDER BY orders_shipped DESC LIMIT 1;"}
{"domain":"northwind","question":"orders per employee","gold_sql":"SELECT e.employee_id, e.first_name, e.last_name, COUNT(o.order_id) AS orders_count FROM employees e JOIN orders o ON o.employee_id = e.employee_id GROUP BY e.employee_id, e.first_name, e.last_name ORDER BY orders_count DESC LIMIT 200;"}
{"domain":"northwind","question":"top 5 employees by order count","gold_sql":"SELECT e.employee_id, e.first_name, e.last_name, COUNT(o.order_id) AS orders_count FROM employees e JOIN orders o ON o.employee_id = e.employee_id GROUP BY e.employee_id, e.first_name, e.last_name ORDER BY orders_count DESC LIMIT 5;"}
{"domain":"northwind","question":"average order value","gold_sql":"SELECT AVG(order_total) AS avg_order_value FROM (SELECT o.order_id, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS order_total FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY o.order_id) t LIMIT 200;"}
{"domain":"northwind","question":"top 10 orders by total value","gold_sql":"SELECT o.order_id, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS order_total FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY o.order_id ORDER BY order_total DESC LIMIT 10;"}
{"domain":"northwind","question":"top 5 customers by number of orders","gold_sql":"SELECT c.customer_id, c.company_name, COUNT(o.order_id) AS orders_count FROM customers c JOIN orders o ON o.customer_id = c.customer_id GROUP BY c.customer_id, c.company_name ORDER BY orders_count DESC LIMIT 5;"}
{"domain":"northwind","question":"customers who placed exactly 1 order","gold_sql":"SELECT c.customer_id, c.company_name FROM customers c JOIN orders o ON o.customer_id = c.customer_id GROUP BY c.customer_id, c.company_name HAVING COUNT(o.order_id) = 1 ORDER BY c.customer_id LIMIT 200;"}
{"domain":"northwind","question":"products never ordered","gold_sql":"SELECT p.product_id, p.product_name FROM products p LEFT JOIN order_details od ON od.product_id = p.product_id WHERE od.order_id IS NULL ORDER BY p.product_id LIMIT 200;"}
{"domain":"northwind","question":"products that are discontinued","gold_sql":"SELECT p.product_id, p.product_name FROM products p WHERE p.discontinued = 1 ORDER BY p.product_id LIMIT 200;"}
