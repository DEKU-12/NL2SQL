{"domain":"chinook","question":"top 5 customers by spend","gold_sql":"SELECT c.first_name, c.last_name, SUM(i.total) AS total_spend FROM customer c JOIN invoice i ON i.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_spend DESC LIMIT 5;"}
{"domain":"chinook","question":"top 10 artists by total track sales","gold_sql":"SELECT ar.name AS artist, SUM(il.unit_price * il.quantity) AS total_sales FROM artist ar JOIN album al ON al.artist_id = ar.artist_id JOIN track t ON t.album_id = al.album_id JOIN invoice_line il ON il.track_id = t.track_id GROUP BY ar.artist_id, ar.name ORDER BY total_sales DESC LIMIT 10;"}
{"domain":"chinook","question":"most popular genre by number of tracks","gold_sql":"SELECT g.name AS genre, COUNT(t.track_id) AS num_tracks FROM genre g JOIN track t ON t.genre_id = g.genre_id GROUP BY g.genre_id, g.name ORDER BY num_tracks DESC LIMIT 1;"}
{"domain":"chinook","question":"total invoices per country","gold_sql":"SELECT billing_country AS country, COUNT(*) AS invoice_count FROM invoice GROUP BY billing_country ORDER BY invoice_count DESC;"}
{"domain":"chinook","question":"top 5 albums by number of tracks","gold_sql":"SELECT al.title AS album, COUNT(t.track_id) AS num_tracks FROM album al JOIN track t ON t.album_id = al.album_id GROUP BY al.album_id, al.title ORDER BY num_tracks DESC LIMIT 5;"}
{"domain":"chinook","question":"customers who never made a purchase","gold_sql":"SELECT c.customer_id, c.first_name, c.last_name, c.email FROM customer c LEFT JOIN invoice i ON i.customer_id = c.customer_id WHERE i.invoice_id IS NULL ORDER BY c.customer_id LIMIT 200;"}
{"domain":"chinook","question":"average invoice total","gold_sql":"SELECT AVG(total) AS avg_invoice_total FROM invoice;"}
{"domain":"chinook","question":"top 5 cities by invoice count","gold_sql":"SELECT billing_city AS city, COUNT(*) AS invoice_count FROM invoice GROUP BY billing_city ORDER BY invoice_count DESC LIMIT 5;"}
{"domain":"chinook","question":"employee who supports most customers","gold_sql":"SELECT e.first_name, e.last_name, COUNT(c.customer_id) AS customer_count FROM employee e JOIN customer c ON c.support_rep_id = e.employee_id GROUP BY e.employee_id, e.first_name, e.last_name ORDER BY customer_count DESC LIMIT 1;"}
{"domain":"chinook","question":"top 5 tracks by unit price","gold_sql":"SELECT t.name AS track, t.unit_price FROM track t ORDER BY t.unit_price DESC, t.track_id ASC LIMIT 5;"}

{"domain":"dvdrental","question":"top 5 customers by total payments","gold_sql":"SELECT c.customer_id, c.first_name, c.last_name, SUM(p.amount) AS total_payments FROM customer c JOIN payment p ON p.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_payments DESC LIMIT 5;"}
{"domain":"dvdrental","question":"most rented film titles","gold_sql":"SELECT f.title, COUNT(*) AS rental_count FROM rental r JOIN inventory i ON i.inventory_id = r.inventory_id JOIN film f ON f.film_id = i.film_id GROUP BY f.film_id, f.title ORDER BY rental_count DESC LIMIT 10;"}
{"domain":"dvdrental","question":"top 5 categories by rentals","gold_sql":"SELECT c.name AS category, COUNT(*) AS rental_count FROM rental r JOIN inventory i ON i.inventory_id = r.inventory_id JOIN film f ON f.film_id = i.film_id JOIN film_category fc ON fc.film_id = f.film_id JOIN category c ON c.category_id = fc.category_id GROUP BY c.category_id, c.name ORDER BY rental_count DESC LIMIT 5;"}
{"domain":"dvdrental","question":"total revenue by month","gold_sql":"SELECT DATE_TRUNC('month', p.payment_date) AS month, SUM(p.amount) AS revenue FROM payment p GROUP BY month ORDER BY month;"}
{"domain":"dvdrental","question":"customers who rented more than 10 times","gold_sql":"SELECT c.customer_id, c.first_name, c.last_name, COUNT(r.rental_id) AS rentals FROM customer c JOIN rental r ON r.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name HAVING COUNT(r.rental_id) > 10 ORDER BY rentals DESC;"}
{"domain":"dvdrental","question":"stores with highest revenue","gold_sql":"SELECT s.store_id, SUM(p.amount) AS revenue FROM store s JOIN staff st ON st.store_id = s.store_id JOIN payment p ON p.staff_id = st.staff_id GROUP BY s.store_id ORDER BY revenue DESC;"}
{"domain":"dvdrental","question":"top 5 actors by number of films","gold_sql":"SELECT a.first_name, a.last_name, COUNT(fa.film_id) AS film_count FROM actor a JOIN film_actor fa ON fa.actor_id = a.actor_id GROUP BY a.actor_id, a.first_name, a.last_name ORDER BY film_count DESC LIMIT 5;"}
{"domain":"dvdrental","question":"average rental duration","gold_sql":"SELECT AVG(EXTRACT(EPOCH FROM (r.return_date - r.rental_date)) / 86400.0) AS avg_days FROM rental r WHERE r.return_date IS NOT NULL;"}
{"domain":"dvdrental","question":"films never rented","gold_sql":"SELECT f.film_id, f.title FROM film f LEFT JOIN inventory i ON i.film_id = f.film_id LEFT JOIN rental r ON r.inventory_id = i.inventory_id WHERE r.rental_id IS NULL ORDER BY f.film_id LIMIT 200;"}
{"domain":"dvdrental","question":"top 10 cities by customers","gold_sql":"SELECT ci.city, COUNT(c.customer_id) AS customers FROM customer c JOIN address a ON a.address_id = c.address_id JOIN city ci ON ci.city_id = a.city_id GROUP BY ci.city_id, ci.city ORDER BY customers DESC LIMIT 10;"}

{"domain":"northwind","question":"top 5 customers by total order value","gold_sql":"SELECT c.customer_id, c.company_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_value FROM customers c JOIN orders o ON o.customer_id = c.customer_id JOIN order_details od ON od.order_id = o.order_id GROUP BY c.customer_id, c.company_name ORDER BY total_value DESC LIMIT 5;"}
{"domain":"northwind","question":"top selling products by quantity","gold_sql":"SELECT p.product_id, p.product_name, SUM(od.quantity) AS total_qty FROM products p JOIN order_details od ON od.product_id = p.product_id GROUP BY p.product_id, p.product_name ORDER BY total_qty DESC LIMIT 10;"}
{"domain":"northwind","question":"revenue by country","gold_sql":"SELECT o.ship_country AS country, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY o.ship_country ORDER BY revenue DESC;"}
{"domain":"northwind","question":"orders per employee","gold_sql":"SELECT e.employee_id, e.first_name, e.last_name, COUNT(o.order_id) AS orders_count FROM employees e JOIN orders o ON o.employee_id = e.employee_id GROUP BY e.employee_id, e.first_name, e.last_name ORDER BY orders_count DESC;"}
{"domain":"northwind","question":"top 5 suppliers by sales","gold_sql":"SELECT s.supplier_id, s.company_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS sales FROM suppliers s JOIN products p ON p.supplier_id = s.supplier_id JOIN order_details od ON od.product_id = p.product_id GROUP BY s.supplier_id, s.company_name ORDER BY sales DESC LIMIT 5;"}
{"domain":"northwind","question":"most used shipper","gold_sql":"SELECT sh.shipper_id, sh.company_name, COUNT(o.order_id) AS orders_shipped FROM shippers sh JOIN orders o ON o.ship_via = sh.shipper_id GROUP BY sh.shipper_id, sh.company_name ORDER BY orders_shipped DESC LIMIT 1;"}
{"domain":"northwind","question":"monthly revenue trend","gold_sql":"SELECT DATE_TRUNC('month', o.order_date) AS month, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY month ORDER BY month;"}
{"domain":"northwind","question":"customers with no orders","gold_sql":"SELECT c.customer_id, c.company_name FROM customers c LEFT JOIN orders o ON o.customer_id = c.customer_id WHERE o.order_id IS NULL ORDER BY c.customer_id LIMIT 200;"}
{"domain":"northwind","question":"top categories by sales","gold_sql":"SELECT cat.category_id, cat.category_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS sales FROM categories cat JOIN products p ON p.category_id = cat.category_id JOIN order_details od ON od.product_id = p.product_id GROUP BY cat.category_id, cat.category_name ORDER BY sales DESC LIMIT 10;"}
{"domain":"northwind","question":"average order value","gold_sql":"SELECT AVG(order_total) AS avg_order_value FROM (SELECT o.order_id, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS order_total FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY o.order_id) t;"}
