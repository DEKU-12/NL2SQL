domain,question,status,error,pred_sql_raw,pred_sql_safe,gold_sql_raw,gold_sql_safe,pred_cols,gold_cols,pred_rows,gold_rows
chinook,top 5 customers by spend,OK,,"SELECT c.first_name, c.last_name, SUM(i.total) AS total_spend 
FROM public.customer c 
JOIN public.invoice i ON c.customer_id = i.customer_id 
GROUP BY c.customer_id 
ORDER BY total_spend DESC 
LIMIT 5;","SELECT c.first_name, c.last_name, SUM(i.total) AS total_spend 
FROM public.customer c 
JOIN public.invoice i ON c.customer_id = i.customer_id 
GROUP BY c.customer_id 
ORDER BY total_spend DESC 
LIMIT 5;","SELECT c.first_name, c.last_name, SUM(i.total) AS total_spend FROM customer c JOIN invoice i ON i.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_spend DESC LIMIT 5;","SELECT c.first_name, c.last_name, SUM(i.total) AS total_spend FROM customer c JOIN invoice i ON i.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_spend DESC LIMIT 5;","['first_name', 'last_name', 'total_spend']","['first_name', 'last_name', 'total_spend']",5.0,5.0
chinook,top 10 artists by total track sales,FAIL_EXEC_PRED,"column t3.quantity does not exist
LINE 1: SELECT T1.name, SUM(T3.quantity * T2.unit_price) AS total_sa...
                            ^
HINT:  Perhaps you meant to reference the column ""t2.quantity"".
","SELECT T1.name, SUM(T3.quantity * T2.unit_price) AS total_sales 
FROM public.artist AS T1 
JOIN public.invoice_line AS T2 ON T1.artist_id = T2.track_id 
JOIN public.track AS T3 ON T2.track_id = T3.track_id 
GROUP BY T1.name 
ORDER BY total_sales DESC 
LIMIT 10;","SELECT T1.name, SUM(T3.quantity * T2.unit_price) AS total_sales 
FROM public.artist AS T1 
JOIN public.invoice_line AS T2 ON T1.artist_id = T2.track_id 
JOIN public.track AS T3 ON T2.track_id = T3.track_id 
GROUP BY T1.name 
ORDER BY total_sales DESC 
LIMIT 10;","SELECT ar.name AS artist, SUM(il.unit_price * il.quantity) AS total_sales FROM artist ar JOIN album al ON al.artist_id = ar.artist_id JOIN track t ON t.album_id = al.album_id JOIN invoice_line il ON il.track_id = t.track_id GROUP BY ar.artist_id, ar.name ORDER BY total_sales DESC LIMIT 10;","SELECT ar.name AS artist, SUM(il.unit_price * il.quantity) AS total_sales FROM artist ar JOIN album al ON al.artist_id = ar.artist_id JOIN track t ON t.album_id = al.album_id JOIN invoice_line il ON il.track_id = t.track_id GROUP BY ar.artist_id, ar.name ORDER BY total_sales DESC LIMIT 10;",,,,
chinook,most popular genre by number of tracks,WRONG,,"SELECT g.name, COUNT(t.track_id) FROM public.genre AS g JOIN public.track AS t ON g.genre_id = t.genre_id GROUP BY g.name ORDER BY COUNT(t.track_id) DESC LIMIT 1;","SELECT g.name, COUNT(t.track_id) FROM public.genre AS g JOIN public.track AS t ON g.genre_id = t.genre_id GROUP BY g.name ORDER BY COUNT(t.track_id) DESC LIMIT 1;","SELECT g.name AS genre, COUNT(t.track_id) AS num_tracks FROM genre g JOIN track t ON t.genre_id = g.genre_id GROUP BY g.genre_id, g.name ORDER BY num_tracks DESC LIMIT 1;","SELECT g.name AS genre, COUNT(t.track_id) AS num_tracks FROM genre g JOIN track t ON t.genre_id = g.genre_id GROUP BY g.genre_id, g.name ORDER BY num_tracks DESC LIMIT 1;","['name', 'count']","['genre', 'num_tracks']",1.0,1.0
chinook,total invoices per country,WRONG,,SELECT COUNT(DISTINCT billing_country) FROM public.invoice LIMIT 1;,SELECT COUNT(DISTINCT billing_country) FROM public.invoice LIMIT 1;,"SELECT billing_country AS country, COUNT(*) AS invoice_count FROM invoice GROUP BY billing_country ORDER BY invoice_count DESC;","SELECT billing_country AS country, COUNT(*) AS invoice_count FROM invoice GROUP BY billing_country ORDER BY invoice_count DESC
LIMIT 200;",['count'],"['country', 'invoice_count']",1.0,24.0
chinook,top 5 albums by number of tracks,WRONG,,"SELECT T1.title, COUNT(T2.track_id) AS num_tracks 
FROM public.album AS T1 
JOIN public.playlist_track AS T2 ON T1.album_id = T2.track_id 
GROUP BY T1.title 
ORDER BY num_tracks DESC 
LIMIT 5;","SELECT T1.title, COUNT(T2.track_id) AS num_tracks 
FROM public.album AS T1 
JOIN public.playlist_track AS T2 ON T1.album_id = T2.track_id 
GROUP BY T1.title 
ORDER BY num_tracks DESC 
LIMIT 5;","SELECT al.title AS album, COUNT(t.track_id) AS num_tracks FROM album al JOIN track t ON t.album_id = al.album_id GROUP BY al.album_id, al.title ORDER BY num_tracks DESC LIMIT 5;","SELECT al.title AS album, COUNT(t.track_id) AS num_tracks FROM album al JOIN track t ON t.album_id = al.album_id GROUP BY al.album_id, al.title ORDER BY num_tracks DESC LIMIT 5;","['title', 'num_tracks']","['album', 'num_tracks']",5.0,5.0
chinook,customers who never made a purchase,WRONG,,SELECT c.* FROM public.customer c LEFT JOIN public.invoice i ON c.customer_id = i.customer_id WHERE i.invoice_id IS NULL LIMIT 10;,SELECT c.* FROM public.customer c LEFT JOIN public.invoice i ON c.customer_id = i.customer_id WHERE i.invoice_id IS NULL LIMIT 10;,"SELECT c.customer_id, c.first_name, c.last_name, c.email FROM customer c LEFT JOIN invoice i ON i.customer_id = c.customer_id WHERE i.invoice_id IS NULL ORDER BY c.customer_id LIMIT 200;","SELECT c.customer_id, c.first_name, c.last_name, c.email FROM customer c LEFT JOIN invoice i ON i.customer_id = c.customer_id WHERE i.invoice_id IS NULL ORDER BY c.customer_id LIMIT 200;","['customer_id', 'first_name', 'last_name', 'company', 'address', 'city', 'state', 'country', 'postal_code', 'phone', 'fax', 'email', 'support_rep_id']","['customer_id', 'first_name', 'last_name', 'email']",0.0,0.0
chinook,average invoice total,WRONG,,SELECT AVG(total) FROM public.invoice LIMIT 1;,SELECT AVG(total) FROM public.invoice LIMIT 1;,SELECT AVG(total) AS avg_invoice_total FROM invoice;,"SELECT AVG(total) AS avg_invoice_total FROM invoice
LIMIT 200;",['avg'],['avg_invoice_total'],1.0,1.0
chinook,top 5 cities by invoice count,WRONG,,"SELECT T2.city, COUNT(T1.customer_id) 
FROM public.invoice AS T1 
JOIN public.customer AS T2 ON T1.customer_id = T2.customer_id 
GROUP BY T2.city 
ORDER BY COUNT(T1.customer_id) DESC 
LIMIT 5;","SELECT T2.city, COUNT(T1.customer_id) 
FROM public.invoice AS T1 
JOIN public.customer AS T2 ON T1.customer_id = T2.customer_id 
GROUP BY T2.city 
ORDER BY COUNT(T1.customer_id) DESC 
LIMIT 5;","SELECT billing_city AS city, COUNT(*) AS invoice_count FROM invoice GROUP BY billing_city ORDER BY invoice_count DESC LIMIT 5;","SELECT billing_city AS city, COUNT(*) AS invoice_count FROM invoice GROUP BY billing_city ORDER BY invoice_count DESC LIMIT 5;","['city', 'count']","['city', 'invoice_count']",5.0,5.0
chinook,employee who supports most customers,FAIL_EXEC_PRED,"column e.support_rep_id does not exist
LINE 3: JOIN public.customer c ON e.support_rep_id = c.customer_id 
                                  ^
HINT:  Perhaps you meant to reference the column ""c.support_rep_id"".
","SELECT e.first_name, e.last_name 
FROM public.employee e 
JOIN public.customer c ON e.support_rep_id = c.customer_id 
GROUP BY e.first_name, e.last_name 
ORDER BY COUNT(c.customer_id) DESC 
LIMIT 1;","SELECT e.first_name, e.last_name 
FROM public.employee e 
JOIN public.customer c ON e.support_rep_id = c.customer_id 
GROUP BY e.first_name, e.last_name 
ORDER BY COUNT(c.customer_id) DESC 
LIMIT 1;","SELECT e.first_name, e.last_name, COUNT(c.customer_id) AS customer_count FROM employee e JOIN customer c ON c.support_rep_id = e.employee_id GROUP BY e.employee_id, e.first_name, e.last_name ORDER BY customer_count DESC LIMIT 1;","SELECT e.first_name, e.last_name, COUNT(c.customer_id) AS customer_count FROM employee e JOIN customer c ON c.support_rep_id = e.employee_id GROUP BY e.employee_id, e.first_name, e.last_name ORDER BY customer_count DESC LIMIT 1;",,,,
chinook,top 5 tracks by unit price,FAIL_EXEC_PRED,"missing FROM-clause entry for table ""i""
LINE 1: SELECT t.name, AVG(i.unit_price * i.quantity) AS avg_unit_pr...
                           ^
","SELECT t.name, AVG(i.unit_price * i.quantity) AS avg_unit_price 
FROM public.track t 
JOIN public.invoice_line il ON t.track_id = il.track_id 
GROUP BY t.name 
ORDER BY avg_unit_price DESC 
LIMIT 5;","SELECT t.name, AVG(i.unit_price * i.quantity) AS avg_unit_price 
FROM public.track t 
JOIN public.invoice_line il ON t.track_id = il.track_id 
GROUP BY t.name 
ORDER BY avg_unit_price DESC 
LIMIT 5;","SELECT t.name AS track, t.unit_price FROM track t ORDER BY t.unit_price DESC, t.track_id ASC LIMIT 5;","SELECT t.name AS track, t.unit_price FROM track t ORDER BY t.unit_price DESC, t.track_id ASC LIMIT 5;",,,,
dvdrental,top 5 customers by total payments,WRONG,,"SELECT c.first_name, c.last_name, SUM(p.amount) AS total_payments 
FROM public.customer c 
JOIN public.payment p ON c.customer_id = p.customer_id 
GROUP BY c.customer_id 
ORDER BY total_payments DESC 
LIMIT 5;","SELECT c.first_name, c.last_name, SUM(p.amount) AS total_payments 
FROM public.customer c 
JOIN public.payment p ON c.customer_id = p.customer_id 
GROUP BY c.customer_id 
ORDER BY total_payments DESC 
LIMIT 5;","SELECT c.customer_id, c.first_name, c.last_name, SUM(p.amount) AS total_payments FROM customer c JOIN payment p ON p.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_payments DESC LIMIT 5;","SELECT c.customer_id, c.first_name, c.last_name, SUM(p.amount) AS total_payments FROM customer c JOIN payment p ON p.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_payments DESC LIMIT 5;","['first_name', 'last_name', 'total_payments']","['customer_id', 'first_name', 'last_name', 'total_payments']",5.0,5.0
dvdrental,most rented film titles,WRONG,,SELECT T1.title FROM public.film AS T1 JOIN public.inventory AS T2 ON T1.film_id = T2.film_id GROUP BY T1.title ORDER BY COUNT(T2.film_id) DESC LIMIT 10;,SELECT T1.title FROM public.film AS T1 JOIN public.inventory AS T2 ON T1.film_id = T2.film_id GROUP BY T1.title ORDER BY COUNT(T2.film_id) DESC LIMIT 10;,"SELECT f.title, COUNT(*) AS rental_count FROM rental r JOIN inventory i ON i.inventory_id = r.inventory_id JOIN film f ON f.film_id = i.film_id GROUP BY f.film_id, f.title ORDER BY rental_count DESC LIMIT 10;","SELECT f.title, COUNT(*) AS rental_count FROM rental r JOIN inventory i ON i.inventory_id = r.inventory_id JOIN film f ON f.film_id = i.film_id GROUP BY f.film_id, f.title ORDER BY rental_count DESC LIMIT 10;",['title'],"['title', 'rental_count']",10.0,10.0
dvdrental,top 5 categories by rentals,FAIL_EXEC_PRED,"column t3.name does not exist
LINE 1: SELECT t3.name, COUNT(t1.film_id) AS num_rents 
               ^
HINT:  Perhaps you meant to reference the column ""t2.name"".
","SELECT t3.name, COUNT(t1.film_id) AS num_rents 
FROM public.film_category AS t1 
JOIN public.category AS t2 ON t1.category_id = t2.category_id 
JOIN public.film AS t3 ON t1.film_id = t3.film_id 
GROUP BY t3.name 
ORDER BY num_rents DESC 
LIMIT 5;","SELECT t3.name, COUNT(t1.film_id) AS num_rents 
FROM public.film_category AS t1 
JOIN public.category AS t2 ON t1.category_id = t2.category_id 
JOIN public.film AS t3 ON t1.film_id = t3.film_id 
GROUP BY t3.name 
ORDER BY num_rents DESC 
LIMIT 5;","SELECT c.name AS category, COUNT(*) AS rental_count FROM rental r JOIN inventory i ON i.inventory_id = r.inventory_id JOIN film f ON f.film_id = i.film_id JOIN film_category fc ON fc.film_id = f.film_id JOIN category c ON c.category_id = fc.category_id GROUP BY c.category_id, c.name ORDER BY rental_count DESC LIMIT 5;","SELECT c.name AS category, COUNT(*) AS rental_count FROM rental r JOIN inventory i ON i.inventory_id = r.inventory_id JOIN film f ON f.film_id = i.film_id JOIN film_category fc ON fc.film_id = f.film_id JOIN category c ON c.category_id = fc.category_id GROUP BY c.category_id, c.name ORDER BY rental_count DESC LIMIT 5;",,,,
dvdrental,total revenue by month,WRONG,,"SELECT 
    EXTRACT(MONTH FROM payment_date) AS month,
    EXTRACT(YEAR FROM payment_date) AS year,
    SUM(amount) AS total_revenue
FROM 
    public.payment
GROUP BY 
    EXTRACT(MONTH FROM payment_date),
    EXTRACT(YEAR FROM payment_date)
ORDER BY 
    year, month","SELECT 
    EXTRACT(MONTH FROM payment_date) AS month,
    EXTRACT(YEAR FROM payment_date) AS year,
    SUM(amount) AS total_revenue
FROM 
    public.payment
GROUP BY 
    EXTRACT(MONTH FROM payment_date),
    EXTRACT(YEAR FROM payment_date)
ORDER BY 
    year, month
LIMIT 200;","SELECT DATE_TRUNC('month', p.payment_date) AS month, SUM(p.amount) AS revenue FROM payment p GROUP BY month ORDER BY month;","SELECT DATE_TRUNC('month', p.payment_date) AS month, SUM(p.amount) AS revenue FROM payment p GROUP BY month ORDER BY month
LIMIT 200;","['month', 'year', 'total_revenue']","['month', 'revenue']",4.0,4.0
dvdrental,customers who rented more than 10 times,WRONG,,"SELECT COUNT(DISTINCT c.customer_id) 
FROM public.rental r
JOIN public.customer c ON r.customer_id = c.customer_id
GROUP BY c.customer_id
HAVING COUNT(r.rental_id) > 10 LIMIT 1;","SELECT COUNT(DISTINCT c.customer_id) 
FROM public.rental r
JOIN public.customer c ON r.customer_id = c.customer_id
GROUP BY c.customer_id
HAVING COUNT(r.rental_id) > 10 LIMIT 1;","SELECT c.customer_id, c.first_name, c.last_name, COUNT(r.rental_id) AS rentals FROM customer c JOIN rental r ON r.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name HAVING COUNT(r.rental_id) > 10 ORDER BY rentals DESC;","SELECT c.customer_id, c.first_name, c.last_name, COUNT(r.rental_id) AS rentals FROM customer c JOIN rental r ON r.customer_id = c.customer_id GROUP BY c.customer_id, c.first_name, c.last_name HAVING COUNT(r.rental_id) > 10 ORDER BY rentals DESC
LIMIT 200;",['count'],"['customer_id', 'first_name', 'last_name', 'rentals']",1.0,200.0
dvdrental,stores with highest revenue,FAIL_EXEC_PRED,"column ""store_id"" does not exist
LINE 1: SELECT store_id, SUM(amount) AS total_revenue 
               ^
HINT:  Perhaps you meant to reference the column ""payment.staff_id"".
","SELECT store_id, SUM(amount) AS total_revenue 
FROM payment 
GROUP BY store_id 
ORDER BY total_revenue DESC 
LIMIT 10;","SELECT store_id, SUM(amount) AS total_revenue 
FROM payment 
GROUP BY store_id 
ORDER BY total_revenue DESC 
LIMIT 10;","SELECT s.store_id, SUM(p.amount) AS revenue FROM store s JOIN staff st ON st.store_id = s.store_id JOIN payment p ON p.staff_id = st.staff_id GROUP BY s.store_id ORDER BY revenue DESC;","SELECT s.store_id, SUM(p.amount) AS revenue FROM store s JOIN staff st ON st.store_id = s.store_id JOIN payment p ON p.staff_id = st.staff_id GROUP BY s.store_id ORDER BY revenue DESC
LIMIT 200;",,,,
dvdrental,top 5 actors by number of films,FAIL_EXEC_PRED,"column t1.first_name does not exist
LINE 1: SELECT T1.first_name, T1.last_name 
               ^
","SELECT T1.first_name, T1.last_name 
FROM public.film_actor AS T1 
JOIN public.film AS T2 ON T1.film_id = T2.film_id 
GROUP BY T1.actor_id, T1.first_name, T1.last_name 
ORDER BY COUNT(T2.film_id) DESC 
LIMIT 5;","SELECT T1.first_name, T1.last_name 
FROM public.film_actor AS T1 
JOIN public.film AS T2 ON T1.film_id = T2.film_id 
GROUP BY T1.actor_id, T1.first_name, T1.last_name 
ORDER BY COUNT(T2.film_id) DESC 
LIMIT 5;","SELECT a.first_name, a.last_name, COUNT(fa.film_id) AS film_count FROM actor a JOIN film_actor fa ON fa.actor_id = a.actor_id GROUP BY a.actor_id, a.first_name, a.last_name ORDER BY film_count DESC LIMIT 5;","SELECT a.first_name, a.last_name, COUNT(fa.film_id) AS film_count FROM actor a JOIN film_actor fa ON fa.actor_id = a.actor_id GROUP BY a.actor_id, a.first_name, a.last_name ORDER BY film_count DESC LIMIT 5;",,,,
dvdrental,average rental duration,WRONG,,SELECT AVG(rental_duration) FROM film,"SELECT AVG(rental_duration) FROM film
LIMIT 200;",SELECT AVG(EXTRACT(EPOCH FROM (r.return_date - r.rental_date)) / 86400.0) AS avg_days FROM rental r WHERE r.return_date IS NOT NULL;,"SELECT AVG(EXTRACT(EPOCH FROM (r.return_date - r.rental_date)) / 86400.0) AS avg_days FROM rental r WHERE r.return_date IS NOT NULL
LIMIT 200;",['avg'],['avg_days'],1.0,1.0
dvdrental,films never rented,WRONG,,"SELECT f.title, COUNT(r.rental_id) 
FROM public.film f 
LEFT JOIN public.rental r ON f.film_id = r.inventory_id 
WHERE r.rental_id IS NULL 
GROUP BY f.title 
LIMIT 1;","SELECT f.title, COUNT(r.rental_id) 
FROM public.film f 
LEFT JOIN public.rental r ON f.film_id = r.inventory_id 
WHERE r.rental_id IS NULL 
GROUP BY f.title 
LIMIT 1;","SELECT f.film_id, f.title FROM film f LEFT JOIN inventory i ON i.film_id = f.film_id LEFT JOIN rental r ON r.inventory_id = i.inventory_id WHERE r.rental_id IS NULL ORDER BY f.film_id LIMIT 200;","SELECT f.film_id, f.title FROM film f LEFT JOIN inventory i ON i.film_id = f.film_id LEFT JOIN rental r ON r.inventory_id = i.inventory_id WHERE r.rental_id IS NULL ORDER BY f.film_id LIMIT 200;","['title', 'count']","['film_id', 'title']",1.0,43.0
dvdrental,top 10 cities by customers,FAIL_EXEC_PRED,"column t1.address_id does not exist
LINE 3: JOIN public.address AS T2 ON T1.address_id = T2.address_id
                                     ^
HINT:  Perhaps you meant to reference the column ""t2.address_id"".
","SELECT T2.city, COUNT(T1.customer_id) 
FROM public.rental AS T1
JOIN public.address AS T2 ON T1.address_id = T2.address_id
GROUP BY T2.city
ORDER BY COUNT(T1.customer_id) DESC
LIMIT 10;","SELECT T2.city, COUNT(T1.customer_id) 
FROM public.rental AS T1
JOIN public.address AS T2 ON T1.address_id = T2.address_id
GROUP BY T2.city
ORDER BY COUNT(T1.customer_id) DESC
LIMIT 10;","SELECT ci.city, COUNT(c.customer_id) AS customers FROM customer c JOIN address a ON a.address_id = c.address_id JOIN city ci ON ci.city_id = a.city_id GROUP BY ci.city_id, ci.city ORDER BY customers DESC LIMIT 10;","SELECT ci.city, COUNT(c.customer_id) AS customers FROM customer c JOIN address a ON a.address_id = c.address_id JOIN city ci ON ci.city_id = a.city_id GROUP BY ci.city_id, ci.city ORDER BY customers DESC LIMIT 10;",,,,
northwind,top 5 customers by total order value,FAIL_EXEC_PRED,"column c.customer_name does not exist
LINE 1: SELECT c.customer_name, SUM(o.total_cost) 
               ^
","SELECT c.customer_name, SUM(o.total_cost) 
FROM orders o 
JOIN customers c ON o.customer_id = c.customer_id 
GROUP BY c.customer_name 
ORDER BY SUM(o.total_cost) DESC 
LIMIT 5;","SELECT c.customer_name, SUM(o.total_cost) 
FROM orders o 
JOIN customers c ON o.customer_id = c.customer_id 
GROUP BY c.customer_name 
ORDER BY SUM(o.total_cost) DESC 
LIMIT 5;","SELECT c.customer_id, c.company_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_value FROM customers c JOIN orders o ON o.customer_id = c.customer_id JOIN order_details od ON od.order_id = o.order_id GROUP BY c.customer_id, c.company_name ORDER BY total_value DESC LIMIT 5;","SELECT c.customer_id, c.company_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_value FROM customers c JOIN orders o ON o.customer_id = c.customer_id JOIN order_details od ON od.order_id = o.order_id GROUP BY c.customer_id, c.company_name ORDER BY total_value DESC LIMIT 5;",,,,
northwind,top selling products by quantity,WRONG,,"SELECT p.product_name, SUM(od.quantity) AS total_quantity 
FROM public.products p
JOIN public.order_details od ON p.product_id = od.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
LIMIT 10;","SELECT p.product_name, SUM(od.quantity) AS total_quantity 
FROM public.products p
JOIN public.order_details od ON p.product_id = od.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
LIMIT 10;","SELECT p.product_id, p.product_name, SUM(od.quantity) AS total_qty FROM products p JOIN order_details od ON od.product_id = p.product_id GROUP BY p.product_id, p.product_name ORDER BY total_qty DESC LIMIT 10;","SELECT p.product_id, p.product_name, SUM(od.quantity) AS total_qty FROM products p JOIN order_details od ON od.product_id = p.product_id GROUP BY p.product_id, p.product_name ORDER BY total_qty DESC LIMIT 10;","['product_name', 'total_quantity']","['product_id', 'product_name', 'total_qty']",10.0,10.0
northwind,revenue by country,FAIL_EXEC_PRED,"column t2.quantity does not exist
LINE 1: SELECT SUM(t1.unit_price * t2.quantity) AS revenue 
                                   ^
HINT:  Perhaps you meant to reference the column ""t1.quantity"".
","SELECT SUM(t1.unit_price * t2.quantity) AS revenue 
FROM public.order_details t1
JOIN public.orders t2 ON t1.order_id = t2.order_id
JOIN public.customers t3 ON t2.customer_id = t3.customer_id
GROUP BY t3.country
ORDER BY revenue DESC
LIMIT 10;","SELECT SUM(t1.unit_price * t2.quantity) AS revenue 
FROM public.order_details t1
JOIN public.orders t2 ON t1.order_id = t2.order_id
JOIN public.customers t3 ON t2.customer_id = t3.customer_id
GROUP BY t3.country
ORDER BY revenue DESC
LIMIT 10;","SELECT o.ship_country AS country, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY o.ship_country ORDER BY revenue DESC;","SELECT o.ship_country AS country, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY o.ship_country ORDER BY revenue DESC
LIMIT 200;",,,,
northwind,orders per employee,WRONG,,"SELECT e.first_name, e.last_name, COUNT(o.order_id) 
FROM public.orders o
JOIN public.employees e ON o.employee_id = e.employee_id
GROUP BY e.first_name, e.last_name
ORDER BY e.first_name, e.last_name
LIMIT 10;","SELECT e.first_name, e.last_name, COUNT(o.order_id) 
FROM public.orders o
JOIN public.employees e ON o.employee_id = e.employee_id
GROUP BY e.first_name, e.last_name
ORDER BY e.first_name, e.last_name
LIMIT 10;","SELECT e.employee_id, e.first_name, e.last_name, COUNT(o.order_id) AS orders_count FROM employees e JOIN orders o ON o.employee_id = e.employee_id GROUP BY e.employee_id, e.first_name, e.last_name ORDER BY orders_count DESC;","SELECT e.employee_id, e.first_name, e.last_name, COUNT(o.order_id) AS orders_count FROM employees e JOIN orders o ON o.employee_id = e.employee_id GROUP BY e.employee_id, e.first_name, e.last_name ORDER BY orders_count DESC
LIMIT 200;","['first_name', 'last_name', 'count']","['employee_id', 'first_name', 'last_name', 'orders_count']",9.0,9.0
northwind,top 5 suppliers by sales,WRONG,,"SELECT s.company_name, SUM(od.unit_price * od.quantity) AS total_sales 
FROM public.suppliers s 
JOIN public.order_details od ON s.supplier_id = od.product_id 
GROUP BY s.company_name 
ORDER BY total_sales DESC 
LIMIT 5;","SELECT s.company_name, SUM(od.unit_price * od.quantity) AS total_sales 
FROM public.suppliers s 
JOIN public.order_details od ON s.supplier_id = od.product_id 
GROUP BY s.company_name 
ORDER BY total_sales DESC 
LIMIT 5;","SELECT s.supplier_id, s.company_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS sales FROM suppliers s JOIN products p ON p.supplier_id = s.supplier_id JOIN order_details od ON od.product_id = p.product_id GROUP BY s.supplier_id, s.company_name ORDER BY sales DESC LIMIT 5;","SELECT s.supplier_id, s.company_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS sales FROM suppliers s JOIN products p ON p.supplier_id = s.supplier_id JOIN order_details od ON od.product_id = p.product_id GROUP BY s.supplier_id, s.company_name ORDER BY sales DESC LIMIT 5;","['company_name', 'total_sales']","['supplier_id', 'company_name', 'sales']",5.0,5.0
northwind,most used shipper,WRONG,,"SELECT T1.company_name, COUNT(T2.order_id) 
FROM public.shippers AS T1 
JOIN public.orders AS T2 ON T1.shipper_id = T2.ship_via 
GROUP BY T1.company_name 
ORDER BY COUNT(T2.order_id) DESC 
LIMIT 1;","SELECT T1.company_name, COUNT(T2.order_id) 
FROM public.shippers AS T1 
JOIN public.orders AS T2 ON T1.shipper_id = T2.ship_via 
GROUP BY T1.company_name 
ORDER BY COUNT(T2.order_id) DESC 
LIMIT 1;","SELECT sh.shipper_id, sh.company_name, COUNT(o.order_id) AS orders_shipped FROM shippers sh JOIN orders o ON o.ship_via = sh.shipper_id GROUP BY sh.shipper_id, sh.company_name ORDER BY orders_shipped DESC LIMIT 1;","SELECT sh.shipper_id, sh.company_name, COUNT(o.order_id) AS orders_shipped FROM shippers sh JOIN orders o ON o.ship_via = sh.shipper_id GROUP BY sh.shipper_id, sh.company_name ORDER BY orders_shipped DESC LIMIT 1;","['company_name', 'count']","['shipper_id', 'company_name', 'orders_shipped']",1.0,1.0
northwind,monthly revenue trend,FAIL_EXEC_PRED,"column o.product_id does not exist
LINE 8:     public.orders o ON p.product_id = o.product_id
                                              ^
HINT:  Perhaps you meant to reference the column ""p.product_id"".
","SELECT 
    p.product_name, 
    EXTRACT(MONTH FROM o.order_date) AS month, 
    SUM(o.order_total) / 12.0 AS monthly_revenue
FROM 
    public.products p
JOIN 
    public.orders o ON p.product_id = o.product_id
GROUP BY 
    p.product_name, 
    EXTRACT(MONTH FROM o.order_date)
ORDER BY 
    p.product_name, 
    month
LIMIT 10;","SELECT 
    p.product_name, 
    EXTRACT(MONTH FROM o.order_date) AS month, 
    SUM(o.order_total) / 12.0 AS monthly_revenue
FROM 
    public.products p
JOIN 
    public.orders o ON p.product_id = o.product_id
GROUP BY 
    p.product_name, 
    EXTRACT(MONTH FROM o.order_date)
ORDER BY 
    p.product_name, 
    month
LIMIT 10;","SELECT DATE_TRUNC('month', o.order_date) AS month, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY month ORDER BY month;","SELECT DATE_TRUNC('month', o.order_date) AS month, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY month ORDER BY month
LIMIT 200;",,,,
northwind,customers with no orders,WRONG,,"SELECT c.* 
FROM public.customers c 
LEFT JOIN public.orders o ON c.customer_id = o.customer_id 
WHERE o.order_id IS NULL LIMIT 1;","SELECT c.* 
FROM public.customers c 
LEFT JOIN public.orders o ON c.customer_id = o.customer_id 
WHERE o.order_id IS NULL LIMIT 1;","SELECT c.customer_id, c.company_name FROM customers c LEFT JOIN orders o ON o.customer_id = c.customer_id WHERE o.order_id IS NULL ORDER BY c.customer_id LIMIT 200;","SELECT c.customer_id, c.company_name FROM customers c LEFT JOIN orders o ON o.customer_id = c.customer_id WHERE o.order_id IS NULL ORDER BY c.customer_id LIMIT 200;","['customer_id', 'company_name', 'contact_name', 'contact_title', 'address', 'city', 'region', 'postal_code', 'country', 'phone', 'fax']","['customer_id', 'company_name']",1.0,2.0
northwind,top categories by sales,WRONG,,"SELECT c.category_name, SUM(od.quantity * od.unit_price) AS total_sales 
FROM products p 
JOIN order_details od ON p.product_id = od.product_id 
JOIN categories c ON p.category_id = c.category_id 
GROUP BY c.category_name 
ORDER BY total_sales DESC 
LIMIT 10;","SELECT c.category_name, SUM(od.quantity * od.unit_price) AS total_sales 
FROM products p 
JOIN order_details od ON p.product_id = od.product_id 
JOIN categories c ON p.category_id = c.category_id 
GROUP BY c.category_name 
ORDER BY total_sales DESC 
LIMIT 10;","SELECT cat.category_id, cat.category_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS sales FROM categories cat JOIN products p ON p.category_id = cat.category_id JOIN order_details od ON od.product_id = p.product_id GROUP BY cat.category_id, cat.category_name ORDER BY sales DESC LIMIT 10;","SELECT cat.category_id, cat.category_name, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS sales FROM categories cat JOIN products p ON p.category_id = cat.category_id JOIN order_details od ON od.product_id = p.product_id GROUP BY cat.category_id, cat.category_name ORDER BY sales DESC LIMIT 10;","['category_name', 'total_sales']","['category_id', 'category_name', 'sales']",8.0,8.0
northwind,average order value,WRONG,,"SELECT AVG(t2.unit_price * t1.quantity) 
FROM order_details t1 
JOIN products t2 ON t1.product_id = t2.product_id","SELECT AVG(t2.unit_price * t1.quantity) 
FROM order_details t1 
JOIN products t2 ON t1.product_id = t2.product_id
LIMIT 200;","SELECT AVG(order_total) AS avg_order_value FROM (SELECT o.order_id, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS order_total FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY o.order_id) t;","SELECT AVG(order_total) AS avg_order_value FROM (SELECT o.order_id, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS order_total FROM orders o JOIN order_details od ON od.order_id = o.order_id GROUP BY o.order_id) t
LIMIT 200;",['avg'],['avg_order_value'],1.0,1.0
