Q: top 5 customers by total order value
SQL: SELECT c.customer_id, c.company_name,
            SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_value
     FROM customers c
     JOIN orders o ON o.customer_id = c.customer_id
     JOIN order_details od ON od.order_id = o.order_id
     GROUP BY c.customer_id, c.company_name
     ORDER BY total_value DESC
     LIMIT 5;

Q: top 10 customers by total order value
SQL: SELECT c.customer_id, c.company_name,
            SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_value
     FROM customers c
     JOIN orders o ON o.customer_id = c.customer_id
     JOIN order_details od ON od.order_id = o.order_id
     GROUP BY c.customer_id, c.company_name
     ORDER BY total_value DESC
     LIMIT 10;

Q: customers with no orders
SQL: SELECT c.customer_id, c.company_name
     FROM customers c
     LEFT JOIN orders o ON o.customer_id = c.customer_id
     WHERE o.order_id IS NULL
     ORDER BY c.customer_id
     LIMIT 200;

Q: revenue by country (ship_country)
SQL: SELECT o.ship_country AS country,
            SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue
     FROM orders o
     JOIN order_details od ON od.order_id = o.order_id
     GROUP BY o.ship_country
     ORDER BY revenue DESC
     LIMIT 200;

Q: monthly revenue trend (by order_date)
SQL: SELECT DATE_TRUNC('month', o.order_date) AS month,
            SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue
     FROM orders o
     JOIN order_details od ON od.order_id = o.order_id
     GROUP BY month
     ORDER BY month
     LIMIT 200;

Q: yearly revenue trend (by order_date)
SQL: SELECT DATE_TRUNC('year', o.order_date) AS year,
            SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue
     FROM orders o
     JOIN order_details od ON od.order_id = o.order_id
     GROUP BY year
     ORDER BY year
     LIMIT 200;

Q: top selling products by quantity
SQL: SELECT p.product_id, p.product_name, SUM(od.quantity) AS total_qty
     FROM products p
     JOIN order_details od ON od.product_id = p.product_id
     GROUP BY p.product_id, p.product_name
     ORDER BY total_qty DESC
     LIMIT 10;

Q: top selling products by revenue
SQL: SELECT p.product_id, p.product_name,
            SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue
     FROM products p
     JOIN order_details od ON od.product_id = p.product_id
     GROUP BY p.product_id, p.product_name
     ORDER BY revenue DESC
     LIMIT 10;

Q: top categories by sales
SQL: SELECT cat.category_id, cat.category_name,
            SUM(od.unit_price * od.quantity * (1 - od.discount)) AS sales
     FROM categories cat
     JOIN products p ON p.category_id = cat.category_id
     JOIN order_details od ON od.product_id = p.product_id
     GROUP BY cat.category_id, cat.category_name
     ORDER BY sales DESC
     LIMIT 10;

Q: top 5 suppliers by sales
SQL: SELECT s.supplier_id, s.company_name,
            SUM(od.unit_price * od.quantity * (1 - od.discount)) AS sales
     FROM suppliers s
     JOIN products p ON p.supplier_id = s.supplier_id
     JOIN order_details od ON od.product_id = p.product_id
     GROUP BY s.supplier_id, s.company_name
     ORDER BY sales DESC
     LIMIT 5;

Q: most used shipper
SQL: SELECT sh.shipper_id, sh.company_name, COUNT(o.order_id) AS orders_shipped
     FROM shippers sh
     JOIN orders o ON o.ship_via = sh.shipper_id
     GROUP BY sh.shipper_id, sh.company_name
     ORDER BY orders_shipped DESC
     LIMIT 1;

Q: orders per employee
SQL: SELECT e.employee_id, e.first_name, e.last_name, COUNT(o.order_id) AS orders_count
     FROM employees e
     JOIN orders o ON o.employee_id = e.employee_id
     GROUP BY e.employee_id, e.first_name, e.last_name
     ORDER BY orders_count DESC
     LIMIT 200;

Q: top 5 employees by order count
SQL: SELECT e.employee_id, e.first_name, e.last_name, COUNT(o.order_id) AS orders_count
     FROM employees e
     JOIN orders o ON o.employee_id = e.employee_id
     GROUP BY e.employee_id, e.first_name, e.last_name
     ORDER BY orders_count DESC
     LIMIT 5;

Q: average order value
SQL: SELECT AVG(order_total) AS avg_order_value
     FROM (
       SELECT o.order_id,
              SUM(od.unit_price * od.quantity * (1 - od.discount)) AS order_total
       FROM orders o
       JOIN order_details od ON od.order_id = o.order_id
       GROUP BY o.order_id
     ) t
     LIMIT 200;

Q: top 10 orders by total value
SQL: SELECT o.order_id,
            SUM(od.unit_price * od.quantity * (1 - od.discount)) AS order_total
     FROM orders o
     JOIN order_details od ON od.order_id = o.order_id
     GROUP BY o.order_id
     ORDER BY order_total DESC
     LIMIT 10;

Q: top 5 customers by number of orders
SQL: SELECT c.customer_id, c.company_name, COUNT(o.order_id) AS orders_count
     FROM customers c
     JOIN orders o ON o.customer_id = c.customer_id
     GROUP BY c.customer_id, c.company_name
     ORDER BY orders_count DESC
     LIMIT 5;

Q: customers who placed exactly 1 order
SQL: SELECT c.customer_id, c.company_name
     FROM customers c
     JOIN orders o ON o.customer_id = c.customer_id
     GROUP BY c.customer_id, c.company_name
     HAVING COUNT(o.order_id) = 1
     ORDER BY c.customer_id
     LIMIT 200;

Q: products never ordered
SQL: SELECT p.product_id, p.product_name
     FROM products p
     LEFT JOIN order_details od ON od.product_id = p.product_id
     WHERE od.order_id IS NULL
     ORDER BY p.product_id
     LIMIT 200;

Q: products that are discontinued
SQL: SELECT p.product_id, p.product_name
     FROM products p
     WHERE p.discontinued = 1
     ORDER BY p.product_id
     LIMIT 200;
