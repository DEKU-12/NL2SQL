Q: average invoice total
SQL: SELECT AVG(i.total) AS avg_invoice_total
     FROM invoice i;

Q: top 5 albums by number of tracks
SQL: SELECT al.title AS album, COUNT(t.track_id) AS num_tracks
     FROM album al
     JOIN track t ON t.album_id = al.album_id
     GROUP BY al.album_id, al.title
     ORDER BY num_tracks DESC
     LIMIT 5;

Q: top 10 artists by total track sales
SQL: SELECT ar.name AS artist, SUM(il.unit_price * il.quantity) AS total_sales
     FROM artist ar
     JOIN album al ON al.artist_id = ar.artist_id
     JOIN track t ON t.album_id = al.album_id
     JOIN invoice_line il ON il.track_id = t.track_id
     GROUP BY ar.artist_id, ar.name
     ORDER BY total_sales DESC
     LIMIT 10;

Q: employee who supports most customers
SQL: SELECT e.first_name, e.last_name, COUNT(c.customer_id) AS customer_count
     FROM employee e
     JOIN customer c ON c.support_rep_id = e.employee_id
     GROUP BY e.employee_id, e.first_name, e.last_name
     ORDER BY customer_count DESC
     LIMIT 1;

Q: top 5 cities by invoice count
SQL: SELECT i.billing_city AS city, COUNT(*) AS invoice_count
     FROM invoice i
     GROUP BY i.billing_city
     ORDER BY invoice_count DESC
     LIMIT 5;

Q: total invoices per country
SQL: SELECT i.billing_country AS country, COUNT(*) AS invoice_count
     FROM invoice i
     GROUP BY i.billing_country
     ORDER BY invoice_count DESC;

Q: top 5 tracks by unit price
SQL: SELECT t.name AS track, t.unit_price
     FROM track t
     ORDER BY t.unit_price DESC, t.track_id ASC
     LIMIT 5;

Q: most popular genre by number of tracks in database
SQL: SELECT g.name AS genre, COUNT(t.track_id) AS num_tracks
     FROM genre g
     JOIN track t ON t.genre_id = g.genre_id
     GROUP BY g.genre_id, g.name
     ORDER BY num_tracks DESC
     LIMIT 1;

Q: customers who never made a purchase
SQL: SELECT c.customer_id, c.first_name, c.last_name
     FROM customer c
     LEFT JOIN invoice i ON i.customer_id = c.customer_id
     WHERE i.invoice_id IS NULL
     LIMIT 200;

Q: top 5 customers by spend
SQL: SELECT c.first_name, c.last_name, SUM(i.total) AS total_spend
     FROM customer c
     JOIN invoice i ON i.customer_id = c.customer_id
     GROUP BY c.customer_id, c.first_name, c.last_name
     ORDER BY total_spend DESC
     LIMIT 5;
